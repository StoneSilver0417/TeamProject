<!DOCTYPE html>
<html>
<head>
<meta charset="EUC-KR">
<title>Insert title here</title>
</head>
<body>
	<table class="table table-hover">
		<thead>
			<tr>
				<th scope="col"></th>
				<th scope="col"></th>
				<th scope="col"></th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="list:${Questinfo}">
				<td th:text="${list.QUEST_NO}"></td>
				<td th:text="${list.QUEST_SEQ}"></td>
				<th>
				<td th:text="${list.QUEST_CONTENT}"></td>
				<th>
			</tr>
		</tbody>
	</table>

	<table class="table">
		<tr>
			<th style="padding: 13px 0 0 15px;">댓글</th>
			<td><input id="reply_content" type="text"
				class="col-md-1 form-control` input-sm" th:value="${reply?.content}" /></td>
		</tr>
	</table>

	<div class="pull-right">
		<button th:if="${board.id}" type="button" class="btn btn-primary"
			id="reply">저장</button>
	</div>

	<h3>댓글출력</h3>
	<table class="table">
		<thead>
			<tr>
				<th scope="col">닉네임</th>
				<th scope="col">내용</th>
			</tr>
		</thead>
		</tbody>
		<tr th:each="reply:${Replyinfo}">
			<span th:if="${reply.QUEST_NO} == ${QUEST.QUEST_NO}">
				<td th:text="${reply.REG_USER}"></td> <!--DB안에 정의돼있는 이름이 id인데도 유저id를 찾으려면 user.username으로 해야한다 이유는 실제 user.model에 있는 username을 찾는것이기때문에 reply.model에서 그 값을 땡겨오려면 실제 이름인 user이라는 모델안에있는 username을 땡겨와야한다-->
				<td th:text="${reply.CONTENT}"></td>
			</span>
		</tr>
		</tbody>
	</table>

	<script th:if="!${qboard?.id}">
		$('#reply').click(function() {
			var jsonData = {
				content : $('#reply_content').val(),
				boardId : $('#Qboard_id').val()
			};

			$.ajax({
				url : "/Qboard/reply",
				type : "POST",
				data : jsonData,
				headers : {
					"Authorization" : "Basic " + btoa("havi" + ":" + "test")
				},
				dataType : "json",
				success : function() {
					alert('저장 성공!');
					location.href = '/reply';
				},
				error : function() {
					alert('저장 실패!');
				}
			});
		});
	</script>

</body>
</html>